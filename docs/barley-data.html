<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Barley Data | Applied Methods in Statistics</title>
  <meta name="description" content="This contains the weekly exercises related to Applied Methods in Statistics (STAT340)">
  <meta name="generator" content="bookdown  and GitBook 2.6.7">

  <meta property="og:title" content="Barley Data | Applied Methods in Statistics" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This contains the weekly exercises related to Applied Methods in Statistics (STAT340)" />
  <meta name="github-repo" content="mathatistics/stat340-2019" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Barley Data | Applied Methods in Statistics" />
  
  <meta name="twitter:description" content="This contains the weekly exercises related to Applied Methods in Statistics (STAT340)" />
  

<meta name="author" content="Raju, Rimal, Kathrine Frey Frøslie and Thore Egeland">



  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="data-from-the-nsr-education-test.html">
<link rel="next" href="multivariate-analysis-pca.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />







<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-113782065-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-113782065-1');
</script>


<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Applied Methods in Statistics</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Practical Information</a></li>
<li class="chapter" data-level="" data-path="getting-started.html"><a href="getting-started.html"><i class="fa fa-check"></i>Getting Started</a><ul>
<li class="chapter" data-level="" data-path="exercise-1-create-new-project.html"><a href="exercise-1-create-new-project.html"><i class="fa fa-check"></i>Exercise 1: Create New Project</a></li>
<li class="chapter" data-level="" data-path="exercise-2-importing-data-in-r.html"><a href="exercise-2-importing-data-in-r.html"><i class="fa fa-check"></i>Exercise 2: Importing data in R</a><ul>
<li><a href="exercise-2-importing-data-in-r.html#import-txt-or-csv">Import <code>txt</code> or <code>csv</code></a></li>
<li class="chapter" data-level="" data-path="exercise-2-importing-data-in-r.html"><a href="exercise-2-importing-data-in-r.html#import-microsoft-excel-spreadsheet"><i class="fa fa-check"></i>Import Microsoft Excel spreadsheet</a></li>
<li><a href="exercise-2-importing-data-in-r.html#load-rdata-rda-or-rds">Load <code>rdata</code>, <code>rda</code> or <code>rds</code></a></li>
<li class="chapter" data-level="" data-path="exercise-2-importing-data-in-r.html"><a href="exercise-2-importing-data-in-r.html#reading-data-from-clipboard-pasting-copied-data-into-an-r-object"><i class="fa fa-check"></i>Reading data from clipboard (“pasting” copied data into an R object)</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="exercise-3-exporting-data-to-a-file.html"><a href="exercise-3-exporting-data-to-a-file.html"><i class="fa fa-check"></i>Exercise 3: Exporting data to a file</a></li>
<li class="chapter" data-level="" data-path="exercise-4-data-structure-in-r.html"><a href="exercise-4-data-structure-in-r.html"><i class="fa fa-check"></i>Exercise 4: Data Structure in R</a><ul>
<li class="chapter" data-level="" data-path="exercise-4-data-structure-in-r.html"><a href="exercise-4-data-structure-in-r.html#vector"><i class="fa fa-check"></i>Vector</a></li>
<li class="chapter" data-level="" data-path="exercise-4-data-structure-in-r.html"><a href="exercise-4-data-structure-in-r.html#matrix"><i class="fa fa-check"></i>Matrix</a></li>
<li class="chapter" data-level="" data-path="exercise-4-data-structure-in-r.html"><a href="exercise-4-data-structure-in-r.html#array"><i class="fa fa-check"></i>Array</a></li>
<li class="chapter" data-level="" data-path="exercise-4-data-structure-in-r.html"><a href="exercise-4-data-structure-in-r.html#list"><i class="fa fa-check"></i>List</a></li>
<li class="chapter" data-level="" data-path="exercise-4-data-structure-in-r.html"><a href="exercise-4-data-structure-in-r.html#data-frame"><i class="fa fa-check"></i>Data Frame</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="exercise-5-exploring-the-data.html"><a href="exercise-5-exploring-the-data.html"><i class="fa fa-check"></i>Exercise 5: Exploring the data</a><ul>
<li class="chapter" data-level="" data-path="exercise-5-exploring-the-data.html"><a href="exercise-5-exploring-the-data.html#structure-of-an-r-object"><i class="fa fa-check"></i>Structure of an R-object</a></li>
<li class="chapter" data-level="" data-path="exercise-5-exploring-the-data.html"><a href="exercise-5-exploring-the-data.html#accessing-elements-from-r-objects"><i class="fa fa-check"></i>Accessing elements from R-objects</a></li>
<li class="chapter" data-level="" data-path="exercise-5-exploring-the-data.html"><a href="exercise-5-exploring-the-data.html#view-data-in-rstudio"><i class="fa fa-check"></i>View Data in RStudio</a></li>
<li class="chapter" data-level="" data-path="exercise-5-exploring-the-data.html"><a href="exercise-5-exploring-the-data.html#summary-of-data"><i class="fa fa-check"></i>Summary of data</a></li>
<li class="chapter" data-level="" data-path="exercise-5-exploring-the-data.html"><a href="exercise-5-exploring-the-data.html#dimension-of-data"><i class="fa fa-check"></i>Dimension of data</a></li>
<li class="chapter" data-level="" data-path="exercise-5-exploring-the-data.html"><a href="exercise-5-exploring-the-data.html#lets-practice"><i class="fa fa-check"></i>Lets Practice</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="exercise-6-subsets-of-data-and-logical-operators.html"><a href="exercise-6-subsets-of-data-and-logical-operators.html"><i class="fa fa-check"></i>Exercise 6: Subsets of data and logical operators</a><ul>
<li class="chapter" data-level="" data-path="exercise-6-subsets-of-data-and-logical-operators.html"><a href="exercise-6-subsets-of-data-and-logical-operators.html#logical-vector-and-index-vector"><i class="fa fa-check"></i>Logical vector and index vector</a></li>
<li class="chapter" data-level="" data-path="exercise-6-subsets-of-data-and-logical-operators.html"><a href="exercise-6-subsets-of-data-and-logical-operators.html#subsetting-data-frame"><i class="fa fa-check"></i>Subsetting data frame</a></li>
<li class="chapter" data-level="" data-path="exercise-6-subsets-of-data-and-logical-operators.html"><a href="exercise-6-subsets-of-data-and-logical-operators.html#exercise-1"><i class="fa fa-check"></i>Exercise</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="exercise-7-graphics.html"><a href="exercise-7-graphics.html"><i class="fa fa-check"></i>Exercise 7: Graphics</a><ul>
<li class="chapter" data-level="" data-path="exercise-7-graphics.html"><a href="exercise-7-graphics.html#spice-up-the-plot"><i class="fa fa-check"></i>Spice up the plot</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="regression-analysis.html"><a href="regression-analysis.html"><i class="fa fa-check"></i>Regression Analysis</a><ul>
<li class="chapter" data-level="" data-path="least-squares-app.html"><a href="least-squares-app.html"><i class="fa fa-check"></i>Least Squares App</a></li>
<li class="chapter" data-level="" data-path="dataset-birth.html"><a href="dataset-birth.html"><i class="fa fa-check"></i>Dataset: birth</a><ul>
<li><a href="dataset-birth.html#overview-of-data"><i class="fa fa-edit"></i> Overview of data</a></li>
<li><a href="dataset-birth.html#linear-regression"><i class="fa fa-book"></i> Linear Regression</a></li>
<li><a href="dataset-birth.html#regression-with-categories"><i class="fa fa-book"></i> Regression with categories</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="dataset-bodydata.html"><a href="dataset-bodydata.html"><i class="fa fa-check"></i>Dataset: bodydata</a><ul>
<li><a href="dataset-bodydata.html#training-samples"><i class="fa fa-book"></i> Training Samples</a></li>
<li><a href="dataset-bodydata.html#fitting-model"><i class="fa fa-edit"></i> Fitting Model</a></li>
<li><a href="dataset-bodydata.html#understanding-the-fitted-model"><i class="fa fa-edit"></i> Understanding the fitted Model</a></li>
<li><a href="dataset-bodydata.html#multiple-linear-regression-and-prediction"><i class="fa fa-edit"></i> Multiple Linear Regression and Prediction</a></li>
<li><a href="dataset-bodydata.html#extra-on-r-squared"><i class="fa fa-book"></i> Extra on R-squared</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="dataset-mtcars.html"><a href="dataset-mtcars.html"><i class="fa fa-check"></i>Dataset: mtcars</a><ul>
<li class="chapter" data-level="" data-path="dataset-mtcars.html"><a href="dataset-mtcars.html#ex-1-model-fitting"><i class="fa fa-check"></i>Ex-1: Model Fitting</a></li>
<li class="chapter" data-level="" data-path="dataset-mtcars.html"><a href="dataset-mtcars.html#ex-2-indicator-variable"><i class="fa fa-check"></i>Ex-2: Indicator variable</a></li>
<li class="chapter" data-level="" data-path="dataset-mtcars.html"><a href="dataset-mtcars.html#ex-3-comparing-models---partial-f-test"><i class="fa fa-check"></i>Ex-3: Comparing models - Partial F-test</a></li>
<li class="chapter" data-level="" data-path="dataset-mtcars.html"><a href="dataset-mtcars.html#ex-4-influential-measurements"><i class="fa fa-check"></i>Ex-4: Influential measurements</a></li>
<li class="chapter" data-level="" data-path="dataset-mtcars.html"><a href="dataset-mtcars.html#ex-5-model-selection"><i class="fa fa-check"></i>Ex-5: Model selection</a></li>
<li class="chapter" data-level="" data-path="dataset-mtcars.html"><a href="dataset-mtcars.html#ex-6-model-validation"><i class="fa fa-check"></i>Ex-6: Model validation</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="analysis-of-variance.html"><a href="analysis-of-variance.html"><i class="fa fa-check"></i>Analysis of variance</a><ul>
<li class="chapter" data-level="" data-path="chlorine-levels-in-cities.html"><a href="chlorine-levels-in-cities.html"><i class="fa fa-check"></i>Chlorine levels in cities</a></li>
<li class="chapter" data-level="" data-path="data-from-the-nsr-education-test.html"><a href="data-from-the-nsr-education-test.html"><i class="fa fa-check"></i>Data from the NSR education test</a></li>
<li class="chapter" data-level="" data-path="barley-data.html"><a href="barley-data.html"><i class="fa fa-check"></i>Barley Data</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="multivariate-analysis-pca.html"><a href="multivariate-analysis-pca.html"><i class="fa fa-check"></i>Multivariate Analysis (PCA)</a><ul>
<li class="chapter" data-level="" data-path="track-and-field-data.html"><a href="track-and-field-data.html"><i class="fa fa-check"></i>Track and Field data</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="multivariate-analysis-pcr-pls.html"><a href="multivariate-analysis-pcr-pls.html"><i class="fa fa-check"></i>Multivariate Analysis (PCR, PLS)</a><ul>
<li class="chapter" data-level="" data-path="prediction-of-cow-milk-percentage.html"><a href="prediction-of-cow-milk-percentage.html"><i class="fa fa-check"></i>Prediction of cow milk percentage</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="discrimination-and-classification.html"><a href="discrimination-and-classification.html"><i class="fa fa-check"></i>Discrimination and classification</a><ul>
<li class="chapter" data-level="" data-path="iris-dataset.html"><a href="iris-dataset.html"><i class="fa fa-check"></i>Iris Dataset</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html"><i class="fa fa-check"></i>Generalized Linear Model</a><ul>
<li class="chapter" data-level="" data-path="species-data.html"><a href="species-data.html"><i class="fa fa-check"></i>Species Data</a></li>
<li class="chapter" data-level="" data-path="taxonomy-data.html"><a href="taxonomy-data.html"><i class="fa fa-check"></i>Taxonomy Data</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="random-effect-model.html"><a href="random-effect-model.html"><i class="fa fa-check"></i>Random Effect Model</a><ul>
<li class="chapter" data-level="" data-path="litter-sizes.html"><a href="litter-sizes.html"><i class="fa fa-check"></i>Litter sizes</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="mixed-effect-model.html"><a href="mixed-effect-model.html"><i class="fa fa-check"></i>Mixed Effect Model</a><ul>
<li class="chapter" data-level="" data-path="exercises-and-diet.html"><a href="exercises-and-diet.html"><i class="fa fa-check"></i>Exercises and Diet</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="exam-questions.html"><a href="exam-questions.html"><i class="fa fa-check"></i>Exam Questions</a><ul>
<li class="chapter" data-level="" data-path="exam-2016.html"><a href="exam-2016.html"><i class="fa fa-check"></i>Exam 2016</a><ul>
<li class="chapter" data-level="" data-path="exam-2016.html"><a href="exam-2016.html#exercise-1-1"><i class="fa fa-check"></i>Exercise 1</a></li>
<li class="chapter" data-level="" data-path="exam-2016.html"><a href="exam-2016.html#exersise-2"><i class="fa fa-check"></i>Exersise 2</a></li>
<li class="chapter" data-level="" data-path="exam-2016.html"><a href="exam-2016.html#exercise-3"><i class="fa fa-check"></i>Exercise 3</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="exam-2017.html"><a href="exam-2017.html"><i class="fa fa-check"></i>Exam 2017</a><ul>
<li class="chapter" data-level="" data-path="exam-2017.html"><a href="exam-2017.html#exercise-1-2"><i class="fa fa-check"></i>Exercise 1</a></li>
<li class="chapter" data-level="" data-path="exam-2017.html"><a href="exam-2017.html#exercise-2"><i class="fa fa-check"></i>Exercise 2</a></li>
<li class="chapter" data-level="" data-path="exam-2017.html"><a href="exam-2017.html#exercise-3-1"><i class="fa fa-check"></i>Exercise 3</a></li>
<li class="chapter" data-level="" data-path="exam-2017.html"><a href="exam-2017.html#exercise-4"><i class="fa fa-check"></i>Exercise 4</a></li>
<li class="chapter" data-level="" data-path="exam-2017.html"><a href="exam-2017.html#appendix-to-exam-stat340"><i class="fa fa-check"></i>Appendix to exam STAT340</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a name="title" href="javascript:void(0)"><b>Lecturer:</b></a><ul>
<li><a href="https://www.nmbu.no/ans/thore.egeland" target="blank">Thore Egeland</a></li></ul></li>
<li><a name="title" href="javascript:void(0)"><b>Assistent Teachers:</b></a><ul>
<li><a href="https://www.nmbu.no/ans/raju.rimal" target="blank">Kathrine Frey Frøslie</a></li></ul></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Applied Methods in Statistics</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="barley-data" class="section level2">
<h2>Barley Data</h2>
<p>In <code>barley.rdata</code> are results from an experiment where the response is yield of barley pr 1000 square meter, and the factors sorts of barley, soil types, types of fertilizers. In addition was the experiment done in two different geographical areas (sites).</p>
<ul>
<li>Assume a two factor model including the main effects of <code>sort</code> and <code>soil</code> and their interaction. State the model and explain all parameters under a sum-to-zero parametrization.</li>
</ul>
<div class="ans">
<p>The model can be written as:</p>
<p><span class="math display">\[ y_{ijk} = \mu + \alpha_i + \beta_j + (\alpha\beta)_{ij} + \epsilon_{ijk}\]</span></p>
<p>where, <span class="math inline">\(\epsilon \sim N(0, \sigma^2)\)</span></p>
<p>The parametrization restrictions for “sum-to-zero”" are:</p>
<p><span class="math display">\[
\begin{aligned} 
\sum_i{\alpha_i} = 0, &amp; \sum_j{\beta_j} = 0, &amp; 
\sum_{i}{(\alpha\beta)_{ij}} = 0  \text{ and }
\sum_{j}{(\alpha\beta)_{ij}} = 0
\end{aligned}
\]</span></p>
</div>
<ul>
<li>Fit the model in R and estimate all parameters</li>
</ul>
<div class="ans">
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">options</span>(<span class="dt">contrasts =</span> <span class="kw">c</span>(<span class="st">&quot;contr.sum&quot;</span>, <span class="st">&quot;contr.poly&quot;</span>))
mod1 &lt;-<span class="st"> </span><span class="kw">lm</span>(Yield <span class="op">~</span><span class="st"> </span>sort <span class="op">*</span><span class="st"> </span>soil, <span class="dt">data =</span> Barley)
summod1 &lt;-<span class="st"> </span><span class="kw">summary</span>(mod1)
summod1<span class="op">$</span>coef</code></pre>
<pre><code>                Estimate Std. Error t value Pr(&gt;|t|)
(Intercept)        380.9       10.1   37.55 1.70e-25
sort(1)            -23.6       10.1   -2.33 2.73e-02
soil(1)            -43.1       10.1   -4.25 2.14e-04
sort(1):soil(1)     13.8       10.1    1.36 1.84e-01</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">summod1<span class="op">$</span>sigma <span class="op">^</span><span class="st"> </span><span class="dv">2</span></code></pre>
<pre><code>[1] 3293</code></pre>
<p>From the model summaries we find the estimated parameters to be:</p>
<ol style="list-style-type: decimal">
<li>The estimated overall mean yield: <span class="math inline">\(\hat{\mu} = 380.94\)</span></li>
<li>The estimated effects of sort 1 and 2: <span class="math inline">\(\hat{\alpha}_1=\)</span> -23.625, <span class="math inline">\(\hat{\alpha}_2 = -\hat{\alpha}_1 =\)</span> 23.625</li>
<li>The estimated effects of soil 1 and 2: <span class="math inline">\(\hat{\beta}_1=\)</span> -43.125, <span class="math inline">\(\hat{\beta}_2 = -\hat{\beta}_1 =\)</span> 43.125</li>
<li>The estimated interaction effects of sort and soil: <span class="math inline">\(\hat{\alpha\beta}_{11}=\)</span> 13.812, <span class="math inline">\(\hat{\alpha\beta}_{12}=-\hat{\alpha\beta}_{11}\)</span> -13.812,
<span class="math inline">\(\hat{\alpha\beta}_{21}=-\hat{\alpha\beta}_{11}\)</span> -13.812,
<span class="math inline">\(\hat{\alpha\beta}_{22}=-\hat{\alpha\beta}_{21}=-\hat{\alpha\beta}_{12}=\)</span> 13.812</li>
<li>The estimated within <code>sort:soil</code> levels unexplained variability: <span class="math inline">\(\hat{\sigma}^2=MSE=\)</span> 3293.21</li>
</ol>
</div>
<ul>
<li>Make an interaction plot and try to conclude about the presence of interaction from the plot. How would you explain interaction effect in this example for a person with experience in agriculture, but minimal statistical experience?</li>
</ul>
<div class="ans">
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(<span class="kw">allEffects</span>(mod1,<span class="dt">confidence.level =</span> <span class="fl">.95</span>))</code></pre>
<p><img src="STAT340-2018_files/figure-html/unnamed-chunk-125-1.svg" width="100%" /></p>
From the plot, it seems that a farmer can expect an increase in yield when using sort 2 instead of sort 1 for both types of soil, and there may be a higher gain of sort 2 over sort 1 for soil-type 2 than for soil type 1. If this is so, there is a so-called interaction effect of sort and soil on yield.
</div>
<ul>
<li>Perform a hypothesis test for the interaction effect. Conclusion?</li>
</ul>
<div class="ans">
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">Anova</span>(mod1, <span class="dt">type =</span> <span class="st">&quot;III&quot;</span>)</code></pre>
<pre><code>Anova Table (Type III tests)

Response: Yield
             Sum Sq Df F value  Pr(&gt;F)    
(Intercept) 4643628  1 1410.06 &lt; 2e-16 ***
sort          17861  1    5.42 0.02731 *  
soil          59513  1   18.07 0.00021 ***
sort:soil      6105  1    1.85 0.18419    
Residuals     92210 28                    
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>The interaction between <code>soil</code> and <code>sort</code> is insignificant (high p-value). This result indicates that the slight non-parallel tendency of the lines in the interaction plot may be due to random errors. More data would be needed to verify any interaction effect.</p>
</div>
<ul>
<li>Fit a four factor model with sort, soil, fert and site as factors and with all possible 2-factor, 3-factor and 4-factor interactions. Use <code>Anova()</code> from the car-package with argument <code>type="III"</code> to produce an ANOVA table. Type III means that
all factors are tested as if they were the last factor to be added to the model.
Are there any higher order significant effects? Compare the R-squared and the adjusted R-squared values. What can you conclude from these?</li>
</ul>
<div class="ans">
<pre class="sourceCode r"><code class="sourceCode r">mod2 &lt;-<span class="st"> </span><span class="kw">lm</span>(Yield <span class="op">~</span><span class="st"> </span>sort <span class="op">*</span><span class="st"> </span>soil <span class="op">*</span><span class="st"> </span>fert <span class="op">*</span><span class="st"> </span>site, <span class="dt">data =</span> Barley)
<span class="kw">Anova</span>(mod2, <span class="dt">type =</span> <span class="st">&quot;III&quot;</span>)</code></pre>
<pre><code>Anova Table (Type III tests)

Response: Yield
                     Sum Sq Df F value    Pr(&gt;F)    
(Intercept)         4643628  1 4503.19   &lt; 2e-16 ***
sort                  17861  1   17.32   0.00073 ***
soil                  59512  1   57.71 0.0000011 ***
fert                   2813  1    2.73   0.11812    
site                   1458  1    1.41   0.25176    
sort:soil              6105  1    5.92   0.02707 *  
sort:fert              2080  1    2.02   0.17472    
soil:fert             33930  1   32.90 0.0000306 ***
sort:site             23220  1   22.52   0.00022 ***
soil:site               595  1    0.58   0.45849    
fert:site               105  1    0.10   0.75364    
sort:soil:fert         2245  1    2.18   0.15953    
sort:soil:site         1405  1    1.36   0.26029    
sort:fert:site         7442  1    7.22   0.01622 *  
soil:fert:site           12  1    0.01   0.91370    
sort:soil:fert:site     406  1    0.39   0.53914    
Residuals             16499 16                      
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(mod2)<span class="op">$</span>r.squared</code></pre>
<pre><code>[1] 0.906</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(mod2)<span class="op">$</span>adj.r.squared</code></pre>
<pre><code>[1] 0.818</code></pre>
<p>There is only one interaction effect significant at 5% levels, namely the
<code>sort:fert:site</code> interaction. However, the least squares estimator is prone to inflated variance estimates and difficulties in finding significance when the number of variables <code>k</code> rises compared to the number of observations <code>N</code> and if variables are highy correlated. To many variables to estimate from a limited number of observations leaves few degrees of freedom to SSE, and tests with low power. Lack of significance may be an over-fitting problem. By removing some of the least significant variables, the problem is reduced, and a reduced model with significant effects may be identified.</p>
<p>The large difference between <span class="math inline">\(R^2\)</span> and <span class="math inline">\(R_{adj}^2\)</span> is also an indication of an over-fitted model.</p>
</div>
<ul>
<li>Fit also a reduced model without site, but all other effects up to 3rd order
interactions. Perform a partial F-test with the <code>anova()</code> function to test whether site (and all its interactions with the others) should be excluded from the model (See also Exercise set 3 and Ex-3).</li>
</ul>
<div class="ans">
<pre class="sourceCode r"><code class="sourceCode r">mod3 &lt;-<span class="st"> </span><span class="kw">lm</span>(Yield <span class="op">~</span><span class="st"> </span>sort <span class="op">*</span><span class="st"> </span>soil <span class="op">*</span><span class="st"> </span>fert, <span class="dt">data =</span> Barley)
<span class="kw">anova</span>(mod2, mod3)</code></pre>
<pre><code>Analysis of Variance Table

Model 1: Yield ~ sort * soil * fert * site
Model 2: Yield ~ sort * soil * fert
  Res.Df   RSS Df Sum of Sq   F Pr(&gt;F)   
1     16 16499                           
2     24 51142 -8    -34644 4.2 0.0071 **
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>The <code>anova</code> result for partial F-test shows that site is needed to a certain degree in the model. The low p-value reject the hypothesis that there is no effect of <code>site</code> on <code>Yield</code>.</p>
</div>
<ul>
<li>In the <code>mixlm</code>-package there are convenient functions for performing automatic model selection by either <code>backward()</code> elimination of factors from a "full-model, by
<code>forward()</code> addition of factors from a minimal model with only intercept, or a combined <code>stepwise()</code> function which combines both forward and backward addition/elimination.</li>
</ul>
<p>For the backward function the least significant factor is removed from the model in each step if the p-value is larger than testlevel <code>alpha</code>. If all factors are significant at any step, the procedure stops. The elimination obeys the so-called marginality principle (hierarchy of factors) which states that any lower order effect or interaction should not be removed from the model if it is part of a higher order significant interaction. This is a good principle for practical data analysis.</p>
<p>Try to run the <code>backward()</code> function on the model object you created above with all four factors and interactions. Use <code>alpha=0.05</code> as test level. Use the Step-information from the output to explain which factors being excluded at each step. What is the final reduced model?</p>
<div class="ans">
<pre class="sourceCode r"><code class="sourceCode r">mod4 &lt;-<span class="st"> </span><span class="kw">backward</span>(mod2, <span class="dt">alpha =</span> <span class="fl">0.05</span>)</code></pre>
<pre><code>Backward elimination, alpha-to-remove: 0.05

Full model: Yield ~ sort * soil * fert * site
&lt;environment: 0x7fe6a38c9770&gt;

                    Step   RSS AIC R2pred   Cp F value Pr(&gt;F)
sort:soil:fert:site    1 16905 231  0.659 14.4    0.39   0.54
soil:fert:site         2 16918 229  0.696 12.4    0.01   0.91
sort:soil:site         3 18322 229  0.704 11.8    1.49   0.24
soil:site              4 18917 228  0.724 10.3    0.62   0.44
sort:soil:fert         5 21162 230  0.720 10.5    2.37   0.14</code></pre>
<p>In the first step, the 4th order interaction is removed. In 2nd, 3rd and 4th step some 3rd order and a 2nd order interactions are removed. After removing interaction between <code>sort</code>,<code>soil</code> and <code>site</code> in the 5th step, the resulting model is,</p>
<pre><code>Yield ~ sort + soil + fert + site + sort:soil + sort:fert + soil:fert + 
    sort:site + fert:site + sort:fert:site</code></pre>
</div>
<ul>
<li>Fit the reduced model and perform a model check using residual analysis.</li>
</ul>
<div class="ans">
<p>The <code>backward</code> function has fitted the reduced model (her named <code>mod4</code>):</p>
<pre class="sourceCode r"><code class="sourceCode r">mod4 &lt;-<span class="st"> </span><span class="kw">lm</span>(Yield <span class="op">~</span><span class="st"> </span>sort <span class="op">+</span><span class="st"> </span>soil <span class="op">+</span><span class="st"> </span>fert <span class="op">+</span><span class="st"> </span>site <span class="op">+</span><span class="st"> </span>sort<span class="op">:</span>soil <span class="op">+</span><span class="st"> </span>
<span class="st">     </span>sort<span class="op">:</span>fert <span class="op">+</span><span class="st"> </span>soil<span class="op">:</span>fert <span class="op">+</span><span class="st"> </span>sort<span class="op">:</span>site <span class="op">+</span><span class="st"> </span>fert<span class="op">:</span>site <span class="op">+</span><span class="st"> </span>sort<span class="op">:</span>fert<span class="op">:</span>site, 
     <span class="dt">data =</span> Barley)

<span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))
<span class="kw">plot</span>(mod4)</code></pre>
<p><img src="STAT340-2018_files/figure-html/unnamed-chunk-131-1.svg" width="100%" /></p>
<p>The residual plots give no evidence of any problems with the model assumptions.</p>
</div>
<ul>
<li>Make an interaction effects plot using the following code:</li>
</ul>
<pre class="sourceCode r"><code class="sourceCode r">eff &lt;-<span class="st"> </span><span class="kw">allEffects</span>(mod4, <span class="dt">confidence.level =</span> <span class="fl">.95</span>)
<span class="kw">plot</span>(eff[<span class="dv">3</span>])</code></pre>
<div class="ans">
<pre class="sourceCode r"><code class="sourceCode r">eff &lt;-<span class="st"> </span><span class="kw">allEffects</span>(mod4, <span class="dt">confidence.level =</span> <span class="fl">.95</span>)
<span class="kw">plot</span>(eff[<span class="dv">3</span>])</code></pre>
<p><img src="STAT340-2018_files/figure-html/effectPlot-1.svg" width="100%" /></p>
</div>
<p>Try to explain the plot. Why do you think the interaction between sort, fertilizer and site was significant?</p>
<div class="ans">
<p>The plot shows that, when changing sort from 1 to 2, a farmer can expect different change in average Yield for <code>site:1</code> and <code>site:2</code> and the difference is not same when using <code>fertilizer:1</code> and <code>fertilizer:2</code>.</p>
</div>

</div>
<!-- </div> -->
<script>
  ans_btn_html = '<a class = "btn-ans"><span class="label label-success no-print">&lt;ANS/&gt;</span></a>';
  showAns_btn = '<a class="showAns-btn btn pull-right js-toolbar-action">Show Answers</a>';
  hideAns_btn = '<a class="hideAns-btn btn pull-right js-toolbar-action" style="display:none;">Hide Answers</a>';
  
  // Adding Extra Menus in Navigation
  
  // Adding button on before each answer:::
  $(".ans").before(ans_btn_html);
  $('.btn-ans').each(function(){
    $(this).next('.ans').andSelf().wrapAll('<div class="wrap-ans"/>');
  });
  $('.btn-ans').click(function(){
    $(this).siblings('.ans').toggle(400);
  });
  
if ($(".ans").length > 0){
    $('.book-header').prepend(showAns_btn, hideAns_btn);
    $('.showAns-btn').show();
    $('.showAns-btn').click(function(){
      $('.btn-ans').hide(400);
      $('.ans').show(400);
      $('.hideAns-btn').show();
      $(this).hide();
      $('.hideAns-btn').click(function(){
        $('.btn-ans').show(400);
        $('.ans').hide(400);
        $('.showAns-btn').show();
        $(this).hide();
      });
    });
  }

var chap = "week-two"
if(window.location.href.indexOf(chap) != -1){
  var now = new Date();
  var release = new Date("August 21, 2016");
  if(now < release){
    $(".ans, .btn-ans, .showAns-btn, .hideAns-btn").hide()
  }
}

$('.ans p:has(img)').css('text-align', 'center');
</script>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-82812028-1', 'auto');
  ga('send', 'pageview');

</script>
            </section>

          </div>
        </div>
      </div>
<a href="data-from-the-nsr-education-test.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="multivariate-analysis-pca.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"download": ["STAT340-2018.pdf", "STAT340-2018.epub"],
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
